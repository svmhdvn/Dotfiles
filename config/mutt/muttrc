###################
# Identity
#
set realname = "Siva Mahadevan"
set from     = "svmhdvn@fastmail.com"

###################
# Local mailboxes
#
set spoolfile = "+INBOX"
set record    = "+Sent"
set trash     = "+Trash"
set postponed = "+Drafts"

####################
# Pager settings
#
ignore *
unignore From Date To Cc Bcc Subject
set pager_stop # don't go to next message automatically
unset markers # no line wrap markers

alternative_order text/plain text/enriched text/html
auto_view text/html
set mailcap_path = $XDG_CONFIG_HOME/mutt/mailcap

####################
# Index
#
set sort     = threads
set sort_aux = reverse-last-date-received

set header_cache = $XDG_CACHE_HOME/mutt/hcache

####################
# Message compositon
#
set sendmail = "msmtp"
set editor = $EDITOR                      # don't use $VISUAL
set edit_headers                          # show headers when composing
set attribution = "%n wrote:"             # cleaner attribution
set fast_reply = yes                      # skip to compose when replying
set include = yes                         # include message in replies
set date_format = "%F at %R %Z"
set index_format = "%Z %[%F] %-30.30n | %s"

####################
# Basic Options
#
set wait_key = no        # shut up, mutt
set mbox_type = Maildir  # mailbox type
set timeout = 0          # no idle time before scanning
set sleep_time = 0       # don't sleep on switching between folders
set mail_check = 0       # minimum time between scans
set confirmappend = no   # don't ask, just do!
set delete               # don't ask, just do!
set mark_old = no        # read/new is good enough for me

####################
# Pager view
set pager_index_lines = 10 # number of index lines to show
set pager_context = 3      # number of context lines to show
set menu_scroll = yes      # scroll in menus

####################
# Colemak keybindings
#

bind index n next-entry
bind index \Cn half-down
bind index e previous-entry
bind index \Ce half-up
bind index g first-entry
bind index G last-entry
bind index k search-next
bind index E edit

bind pager n next-line
bind pager N next-entry
bind pager \Cn half-down
bind pager e previous-line
bind pager E previous-entry
bind pager \Ce half-up
bind pager g top
bind pager G bottom
bind pager k search-next

# Mail operations

# Sync email
macro index % "<shell-escape>mbsync fastmail<enter>" "run mbsync to sync all mail"

# URLscan
macro index,pager \Cu "<pipe-message>urlscan<enter>" "call urlscan to extract URLs out of a message"

# Save to archive
macro index,pager y "<save-message>=Archive<enter>" "Archive"

# Quick navigation of folders
macro index ta "<change-folder>=Archive<enter>" "Go to Archive"
macro index ti "<change-folder>=INBOX<enter>" "Go to INBOX"
macro index tt "<change-folder>=Trash<enter>" "Go to Trash"
macro index ts "<change-folder>=Sent<enter>" "Go to Sent"
macro index td "<change-folder>=Drafts<enter>" "Go to Drafts"

# Patch syntax highlighting                                                     
#color   normal  white           default                                         
color   body    brightwhite     default         ^[[:space:]].*                  
color   body    yellow          default         ^(diff).*                       
#color   body    white           default         ^[\-\-\-].*                     
#color   body    white           default         ^[\+\+\+].*                     
#color   body    green           default         ^[\+].*                         
#color   body    red             default         ^[\-].*                         
#color   body    brightblue      default         [@@].*                          
color   body    brightwhite     default         ^(\s).*                         
color   body    cyan            default         ^(Signed-off-by).*
color   body    cyan            default         ^(Docker-DCO-1.1-Signed-off-by).*
color   body    brightwhite     default         ^(Cc)
color   body    yellow          default         "^diff \-.*"
color   body    brightwhite     default         "^index [a-f0-9].*"
color   body    brightblue      default         "^---$"
color   body    white           default         "^\-\-\- .*"
color   body    white           default         "^[\+]{3} .*"
color   body    green           default         "^[\+][^\+]+.*"
color   body    red             default         "^\-[^\-]+.*"
color   body    brightblue      default         "^@@ .*"
color   body    green           default         "LGTM"
color   body    brightmagenta   default         "-- Commit Summary --"
color   body    brightmagenta   default         "-- File Changes --"
color   body    brightmagenta   default         "-- Patch Links --"
color   body    green           default         "^Merged #.*"
color   body    red             default         "^Closed #.*"
color   body    brightblue      default         "^Reply to this email.*"
