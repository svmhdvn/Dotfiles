###################
# Identity
#
set realname = "Siva Mahadevan"
set from     = "svmhdvn@fastmail.com"

###################
# Local mailboxes
#
set spoolfile = "+INBOX"
set record    = "+Sent"
set trash     = "+Trash"
set postponed = "+Drafts"

####################
# Pager settings
#
ignore *
unignore From Date To Cc Bcc Subject
set pager_stop # don't go to next message automatically
unset markers # no line wrap markers

alternative_order text/plain text/enriched text/html
auto_view text/html
set mailcap_path = $XDG_CONFIG_HOME/mutt/mailcap

####################
# Index
#
set sort     = threads
set sort_aux = reverse-last-date-received

set header_cache = $XDG_CACHE_HOME/mutt/hcache

####################
# Message compositon
#
set editor = $EDITOR                      # don't use $VISUAL
set edit_headers                          # show headers when composing
set sendmail  = "msmtp"
set attribution = "%n wrote:"             # cleaner attribution
set fast_reply = yes                      # skip to compose when replying
set include = yes                         # include message in replies
set date_format = "%F at %R %Z"
set index_format = "%Z %[%b %d] %-30.30n | %s"

####################
# Basic Options
#
set wait_key = no        # shut up, mutt
set mbox_type = Maildir  # mailbox type
set timeout = 0          # no idle time before scanning
set sleep_time = 0       # don't sleep on switching between folders
set mail_check = 0       # minimum time between scans
set delete = no          # don't delete, just move to trash
set confirmappend = no   # don't ask, just do!
set mark_old = no        # read/new is good enough for me

####################
# Pager view
set pager_index_lines = 10 # number of index lines to show
set pager_context = 3      # number of context lines to show
set menu_scroll = yes      # scroll in menus

####################
# Vim keybindings
#

# Sync email
macro index % "<shell-escape>mbsync fastmail<enter>" "run mbsync to sync all mail"

# URLscan functionality
macro index,pager \Cu "<pipe-message> urlscan<Enter>" "call urlscan to extract URLs out of a message"
macro attach,compose \Cu "<pipe-entry> urlscan<Enter>" "call urlscan to extract URLs out of a message"

macro index,pager d "<save-message>+Trash<enter>" "Trash"
macro index,pager y "<save-message>+Archive<enter>" "Archive"

# Quick navigation of folders
macro index ga "<change-folder>+Archive<enter>" "Go to Archive"
macro index gi "<change-folder>+INBOX<enter>" "Go to INBOX"
macro index gt "<change-folder>+Trash<enter>" "Go to Trash"
macro index gs "<change-folder>+Sent<enter>" "Go to Sent"
macro index gd "<change-folder>+Drafts<enter>" "Go to Drafts"

# patch syntax highlighting
color body cyan default "^diff \-.*"
color body cyan default "^index [a-f0-9].*"
color body cyan default "^\-\-\- .*"
color body cyan default "^[\+]{3} .*"
color body green default "^[\+][^\+]+.*"
color body red default "^\-[^\-]+.*"
color body brightblue default "^@@ .*"
